# 代理模式

## 1. 基本介绍

代理模式（Proxy），为其他对象提供一种代理以控制这个对象的访问

## 2. 结构图

![image-20220428175110352](E:\lcsprogram\study_doc\设计模式\image\代理模式结构图.png)

## 3. 代理模式的应用

1. 远程代理，也就是一个对象在不同的地址空间提供局部代表。这样可以隐藏一个对象存在于不同地址空间的事实
2. 虚拟代理，根据需要创建开销很大的对象。通过它来存放实例化需要很长时间的真实对象
3. 安全代理，用来控制真实对象的权限
4. 智能代理，当调用真实对象时，代理处理另外一些事情

## 4. 代码

`Subject.h`

```cpp
#ifndef __SUBJECT_H
#define __SUBJECT_H

class Subject
{
public:
    virtual void request() = 0;
};

#endif
```

`RealSubject.h`

```cpp
#ifndef __REALSUBJECT_H
#define __REALSUBJECT_H
#include"Subject.h"
#include<iostream>
using namespace std;

class RealSubject : public Subject
{
public:
    void request() {
        cout << "这里是真实的请求" << endl;
    }
};

#endif
```

`ProxySubject.h`

```cpp
#ifndef __PROXYSUBJECT_H
#define __PROXYSUBJECT_H
#include"Subject.h"
#include"RealSubject.h"

class ProxySubject : public Subject
{
public:
    void request() {
        if (realSubject == nullptr) {
            realSubject = new RealSubject();
        }
        realSubject->request();
    }
private:
    RealSubject* realSubject;
};

#endif
```

`test.cpp`

```cpp
#include"ProxySubject.h"

int main() {
    ProxySubject* proxy = new ProxySubject();
    proxy->request();
    
    return 1;
}
```

