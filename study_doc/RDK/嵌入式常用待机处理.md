# 嵌入式常用待机处理

## 1. 待机方式

通常情况一般将待机分为三种

**假待机**：仅仅关闭屏幕，其他几乎正常

一般表现为，屏幕关闭，串口还能正常工作，能正常看到大部分服务仍在运行

**待机到内存**：挂起进程服务到内存，关闭CPU，将DDR转化为低功耗模式

一般表现为，cpu掉电，串口无法正常工作，接收到唤醒指令后能快速起来，并恢复或继续执行待机之前的动作

**真待机**：关闭CPU和DDR，相当与断电

一般表现为关闭所有程序和服务，并将系统关闭，接收到唤醒指令后，重新启动，初始化进入系统，无法恢复到待机之前的状态

## 2. 实现方式

1. **假待机**

   待遇amlogic芯片来说，执行以下操作为待机

   ```bash
   echo 1 > /sys/class/meson_pm/early_suspend_trigger
   ```

   唤醒

   ```bash
   echo 0 > /sys/class/meson_pm/early_suspend_trigger
   ```

2. **待机到内存**

   linux内核提供的待机模式其实由四种，`s2idle`（待机到空闲），`standby`（低功耗待机），`suspend`（待机到内存），`hibernate`（待机到硬盘）。其中 `s2idle` 和 `suspend` 两种是嵌入式都具备的，另外两种需要一定的硬件和移植支持。
   linux内核提供了以下空间接口以方便用户对待机事件的操作。

   `/sys/power/state`

3. **真待机**

